<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/jszip.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.8.0/xlsx.js"></script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="~/jquery/jquery.min.js"></script>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js" integrity="sha384-BBtl+eGJRgqQAUMxJ7pMwbEyER4l1g+O15P+16Ep7Q9Q+zqX6gSbd85u4mG4QzX+" crossorigin="anonymous"></script>
<form method="post" enctype="multipart/form-data">
    <div class="row">
        <label>Select File</label>
        <input type="file" name="file" />
    </div>
    <div class="row" style="padding-top: 10px;">
        <div class="col-3">
            <input type="submit" asp-controller="Home" asp-action="ExcelFileReader" class="btn btn-dark" value="Read Excel File" />

        </div>
    </div>
</form>

<table class="table">
    <thead>
        <tr>
            @if (ViewBag.ExcelData != null && ViewBag.ExcelData.Count > 0)
            {
                @foreach (var header in ViewBag.ExcelData[0])
                {
                    <th>@header</th>   
                }
            }
        </tr>
    </thead>
    <tbody>
        @if (ViewBag.ExcelData != null && ViewBag.ExcelData.Count > 1)
        {
            @for (int i = 1; i < ViewBag.ExcelData.Count; i++)
            {
                <tr>
                    @foreach(var cell in ViewBag.ExcelData[i])
                    {
                        <td>@cell</td>
                    }
                </tr>   
            }
        }
    </tbody>
</table>